{"version":3,"sources":["../src/Hover.js"],"names":["NULL_HOVER","contents","HoverSupport","constructor","documents","flow","provideHover","params","position","textDocument","fileName","uri","doc","get","typeHint","buffer","language","value","hint","range"],"mappings":";;;;;;;;;;AAYA;;AAEA;;;;AACA;;;;AAWA,MAAMA,aAAa;AACjBC,YAAU;AADO,CAAnB,C,CA1BA;;;;;;;;;;;;AA8Be,MAAMC,YAAN,CAAmB;;AAIhCC,cAAY,EAACC,SAAD,EAAYC,IAAZ,EAAZ,EAAmD;AACjD,SAAKD,SAAL,GAAiBA,SAAjB;AACA,SAAKC,IAAL,GAAYA,IAAZ;AACD;;AAEKC,cAAN,CAAmBC,MAAnB,EAAwE;AAAA;;AAAA;AAAA,YAC/DC,QAD+D,GACrCD,MADqC,CAC/DC,QAD+D;AAAA,YACrDC,YADqD,GACrCF,MADqC,CACrDE,YADqD;;;AAGtE,YAAMC,WAAW,yBAAcD,aAAaE,GAA3B,CAAjB;AACA,YAAMC,MAAM,MAAKR,SAAL,CAAeS,GAAf,CAAmBJ,aAAaE,GAAhC,CAAZ;;AAEA,YAAMG,WAAW,MAAM,MAAKT,IAAL,CAAUS,QAAV,CACrBJ,QADqB,EAErBE,IAAIG,MAFiB,EAGrB,kCAAuBP,QAAvB,CAHqB,CAAvB;;AAMA,UAAIM,QAAJ,EAAc;AACZ,eAAO;AACLb,oBAAU,EAACe,UAAU,YAAX,EAAyBC,OAAOH,SAASI,IAAzC,EADL;AAELC,iBAAO,+BAAoBL,SAASK,KAA7B;AAFF,SAAP;AAID;;AAED,aAAOnB,UAAP;AAnBsE;AAoBvE;AA7B+B;kBAAbE,Y","file":"Hover.js","sourcesContent":["/**\n * Copyright (c) 2017-present, Facebook, Inc.\n * All rights reserved.\n *\n * This source code is licensed under the BSD-style license found in the\n * LICENSE file in the root directory of this source tree. An additional grant\n * of patent rights can be found in the PATENTS file in the same directory.\n *\n * @flow\n * @format\n */\n\nimport {FlowSingleProjectLanguageService} from './pkg/nuclide-flow-rpc/lib/FlowSingleProjectLanguageService';\n\nimport TextDocuments from './TextDocuments';\nimport {\n  atomRangeToLSPRange,\n  lspPositionToAtomPoint,\n  fileURIToPath,\n} from './utils/util';\n\ntype HoverSupportParams = {\n  documents: TextDocuments,\n  flow: FlowSingleProjectLanguageService,\n};\n\nconst NULL_HOVER = {\n  contents: [],\n};\n\nexport default class HoverSupport {\n  documents: TextDocuments;\n  flow: FlowSingleProjectLanguageService;\n\n  constructor({documents, flow}: HoverSupportParams) {\n    this.documents = documents;\n    this.flow = flow;\n  }\n\n  async provideHover(params: TextDocumentPositionParams): Promise<?Hover> {\n    const {position, textDocument} = params;\n\n    const fileName = fileURIToPath(textDocument.uri);\n    const doc = this.documents.get(textDocument.uri);\n\n    const typeHint = await this.flow.typeHint(\n      fileName,\n      doc.buffer,\n      lspPositionToAtomPoint(position),\n    );\n\n    if (typeHint) {\n      return {\n        contents: {language: 'javascript', value: typeHint.hint},\n        range: atomRangeToLSPRange(typeHint.range),\n      };\n    }\n\n    return NULL_HOVER;\n  }\n}\n"]}